###### 注意：服务器之间文件流的传输，比如client传到server，避免直接使用file传输，而是先转换成流，然后server接收并且写入server服务器的目录文件中。再提供外部接口使用。（直接传file给server，会导致server找不到该文件）

##### 使用apache的FileUtils工具类进行写入流
FileUtils.copyInputStreamToFile(inputStream,newFile);

```
@SuppressWarnings("unchecked")
    @Override
    @PostMapping
    public ResultBean<Object> uploadPicture(String lang, UploadReq uploadReq, InputStream inputStream, String newFileName) {
        File newFile = null;
        try {
            String path = "/opt/plus_upload/img/";

			//创建File
            newFile = new File(path + newFileName);
			// 检测是否存在目录
			if (!newFile.getParentFile().exists()) {
			    newFile.getParentFile().mkdirs();
			}

			//检测是否创建文件
			if (!newFile.exists()){
                newFile.createNewFile();
            }
            FileUtils.copyInputStreamToFile(inputStream,newFile);

            //调用cms上传接口
            UploadRes res = cmsService.upload(newFile);

            if (res == null){
                LOGGER.error("上传图片异常,cms返回空");
                return ResultUtil.fail(RightsPackageErrorCode.UPLOAD_PICTURE_ERROR, lang);
            }else if(SUCCESS_CODE.equals(res.getErrorcode())
                    && SUCCESS_STATUS.equals(res.getStatus())
                    && CollectionUtils.isNotEmpty(res.getDatas())) {
                List<UploadDate> datas = res.getDatas();
                UploadDate uploadDate = datas.get(0);

                List<String> list = new ArrayList<>();
                list.add(uploadDate.getPath());

                PublishReq publishReq = new PublishReq();
                publishReq.setName(list);

                //调用cms发布接口
                PublishRes publishres = cmsService.publish(publishReq);
                if (publishres == null){
                    LOGGER.error("cms发布图片异常,返回为空");
                    return ResultUtil.fail(RightsPackageErrorCode.PUBLIS_PICTURE_ERROR, lang);
                }else if (SUCCESS_CODE.equals(publishres.getErrorcode())
                        && SUCCESS_STATUS.equals(publishres.getStatus())
                        && CollectionUtils.isNotEmpty(publishres.getData())){
                    return ResultUtil.success(publishres.getData().get(0));
                }else {
                    LOGGER.error("cms发布图片异常,原因:{}",publishres.getMessage());
                    return ResultUtil.fail(publishres.getMessage(), LocalConstants.CMS_INTERFACE, publishres.getErrorcode(), lang);
                }
            }else {
                LOGGER.error("上传图片异常,原因:{}",res.getMessage());
                return ResultUtil.fail(res.getMessage(), LocalConstants.CMS_INTERFACE, res.getErrorcode(), lang);
            }
        } catch (Exception e) {
            LOGGER.error("上传图片异常：{}", e.getMessage(), e);
            return ResultUtil.fail(RightsPackageErrorCode.UPLOAD_PICTURE_ERROR, lang);
        }
        finally {
            //删除临时文件
            if (newFile != null){
                deleteFile(newFile);
            }
        }
    }
```


##### 读取文件


- FileInputStream：字节输入流
- InputStreamReader：字节转换成字符
- BufferedReader：字符输入流

```
public void readJson(){
		StringBuffer buffer = new StringBuffer();
		BufferedReader br;
		try {
//			br = new BufferedReader(new FileReader("D:\\result.json"));
			br = new BufferedReader(new InputStreamReader(new FileInputStream("D:\\result.json"), "GBK"));
			String sname = null;
			while ((sname = br.readLine()) != null) {
				// System.out.println(sname);
				buffer.append(sname);
			}
			br.close();
		} catch (IOException e1) {
			e1.printStackTrace();
		}
		JSONObject jsonObject = JSONObject.parseObject(buffer.toString());
		System.out.println(jsonObject.toJSONString());
	}
```

##### 写入文件

- FileOutputStream：字节输出流
- OutputStreamWrite：字符转换成字节
- BufferedWrite：字符输出流

```
private void write(String fileName,String data) {
        BufferedWriter writer = null;  
        File file = new File("d:\\"+ fileName + ".json");  
        
        //判断父类目录是否存在
        if(!file.getParentFile().exists()){
            file.getParentFile().mkdirs();
        }
        
        //如果文件不存在，则新建一个  
        if(!file.exists()){  
            file.createNewFile();  
        }  
        //写入  
        try {  
            writer = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(file,false), "UTF-8"));  
            writer.write(data);  
        } catch (IOException e) {  
            e.printStackTrace();  
        }finally {  
            try {  
                if(writer != null){  
                    writer.close();  
                }  
            } catch (IOException e) {  
                e.printStackTrace();  
            }  
        }  
       System.out.println("文件写入成功！");  
```
