[toc]

## 文件系统

定义：能够为用户提供在计算机系统中对数据信息进行**长期**、大量**存储**和**访问**的功能**文件系统**。包含了文件及管理文件的软件集合

### 1. 文件

文件系统的用户接口包括文件的<font style=color:red>命名</font>、<font style=color:red>类型</font>、<font style=color:red>属性</font>和对文件的<font style=color:red>操作</font>。

- 命名：所有操作系统都允许用**1～8个字母组成**的字符串。多数操作系统都支持文件名用**圆点隔开**分为两部分，圆点后面的部分称为**文件扩展名**
- 属性：除了文件名和文件数据外，其他与文件相关的信息，如创建日期、文件大小、修改时间等
- 存取
  - 顺序存取：早期，从文件开始处读取信息，不能跳过
  - 随机存取：又称直接存取，可以以任意顺序读取文件信息


#### 1.1 类型

​		![image-20220929003045940](images/image-20220929003045940.png)

#### 1.2 文件结构

![image-20220929002626549](images/image-20220929002626549.png)

- 无结构字节序列（流式文件）


- 固定长度记录序列

- 树形结构（B树）

#### 1.3 文件操作

​			![image-20220929003302264](images/image-20220929003302264.png)





### 2. 目录

目录是文件系统中实现<font style=color:red>按名访问</font>的重要数据结构。

#### 2.1 目录文件结构

目录文件结构分为两种，分别是一下两种：

![image-20220929003728892](images/image-20220929003728892.png)

#### 2.2 目录结构

单层结构、两级结构、树结构

![image-20220927002455678](images/image-20220927002455678.png)

![image-20220927002338423](images/image-20220927002338423.png)



#### 2.3 路径名

采用树形目录时，需要有某种方法指明文件

- **绝对路径名**：从根目录到文件

- **相对路径名**：从当前工作目录到文件



#### 2.4 目录操作

​							![image-20220929004034887](images/image-20220929004034887.png)







### 3. 文件系统的实现

#### 3.1 实现文件

![image-20220929075724765](images/image-20220929075724765.png)

##### 连续分配

![image-20220929080402973](images/image-20220929080402973.png)

- 优点
  - 实现简单：每个簇只需记录<font style=color:red>第一块的地址和文件的块数</font>
  - 顺序读性能好
- 缺点：磁盘变得零碎，空闲的连续簇形成“<font style=color:red>空洞</font>”。

##### 磁盘链接表（链表）

![image-20220929080657718](images/image-20220929080657718.png)

- 优点：<font style=color:red>充分利用每个簇</font>，不会因为磁盘碎片而浪费空间。
- 缺点：<font style=color:red>随机存取相当缓慢</font>，要获得文件的第 n 块，每一次都要从链表头开始读取前面的 n-1 块。


##### 内存链接分配表

![image-20220929080920079](images/image-20220929080920079.png)

- 缺点：必须将<font style=color:red>整个分配表存放在内存</font>，磁盘文件容量很大时，占用内存比较大

##### i-结点

![image-20220929081125226](images/image-20220929081125226.png)

例题1

![image-20220929081243994](images/image-20220929081243994.png)

例题2

![image-20220929081316268](images/image-20220929081316268.png)





#### 3.2 实现目录

![image-20220929081621857](images/image-20220929081621857.png)



#### 3.3 磁盘管理

![image-20220929082016382](images/image-20220929082016382.png)

##### 记录空闲块

​				![image-20220929082159056](images/image-20220929082159056.png)