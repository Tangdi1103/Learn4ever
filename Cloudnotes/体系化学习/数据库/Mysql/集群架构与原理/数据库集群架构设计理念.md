[toc]

## 数据库架构设计

### 1. 架构设计理念

- 可用性
- 扩展性
- 一致性



### 2. 可用性设计

实现数据库高可用的架构模式如下：

- 主从模式：一主多从，读的高可用，但写高可用需手动将从库切换为主库
- 双主模式：双主多从，在主从模式基础上，实现双主热备，实现读高可用



### 3. 扩展性设计

扩展性的设计主要涉及读扩展和写扩展

- 读扩展：
  - 增加从库：操作简单，但从库太多会影响主从复制的性能，对主库造成性能损耗
  - 分库分表
    - 垂直拆分：所有实例都有完整的数据，但无法突破单机读瓶颈
    - 水平拆分：每个实例都只有部分数据，可无限扩展
- 写阔扩展：
  - 分库分表
    - 垂直拆分：所有实例都有完整的数据，但无法突破单机读瓶颈
    - 水平拆分：每个实例都只有部分数据，可无限扩展



### 4. 一致性设计

一致性的设计主要涉及主从模式的同步延时问题

- 依靠数据库中间件来完成路由（MySQL Proxy、Mycat、ShardingSphere）

  比如在同步延时 T 时间内，读操作直接路由给主库，同步完成后的读操作路由给从库

